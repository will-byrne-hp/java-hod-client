<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-07-15 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20150715" />
    <meta http-equiv="Content-Language" content="en" />
    <title>java-hod-client &#x2013; java-hod-client</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

    
                  </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/hpautonomy/java-hod-client">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>java-hod-client</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2015-07-15
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 0.10.0
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                          
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-down"></i>
        Project Information</a>
                    <ul class="nav nav-list">
                    
      <li class="active">
  
            <a href="#"><i class="none"></i>About</a>
          </li>
                    
      <li>
  
                          <a href="project-summary.html" title="Project Summary">
          <i class="none"></i>
        Project Summary</a>
            </li>
                    
      <li>
  
                          <a href="dependency-info.html" title="Dependency Information">
          <i class="none"></i>
        Dependency Information</a>
            </li>
                    
      <li>
  
                          <a href="license.html" title="Project License">
          <i class="none"></i>
        Project License</a>
            </li>
                    
      <li>
  
                          <a href="team-list.html" title="Project Team">
          <i class="none"></i>
        Project Team</a>
            </li>
                    
      <li>
  
                          <a href="source-repository.html" title="Source Repository">
          <i class="none"></i>
        Source Repository</a>
            </li>
                    
      <li>
  
                          <a href="issue-tracking.html" title="Issue Tracking">
          <i class="none"></i>
        Issue Tracking</a>
            </li>
                    
      <li>
  
                          <a href="dependencies.html" title="Dependencies">
          <i class="none"></i>
        Dependencies</a>
            </li>
                    
      <li>
  
                          <a href="plugin-management.html" title="Plugin Management">
          <i class="none"></i>
        Plugin Management</a>
            </li>
                    
      <li>
  
                          <a href="plugins.html" title="Project Plugins">
          <i class="none"></i>
        Project Plugins</a>
            </li>
                    
      <li>
  
                          <a href="distribution-management.html" title="Distribution Management">
          <i class="none"></i>
        Distribution Management</a>
            </li>
                    
      <li>
  
                          <a href="apidocs/index.html" title="API Javadoc">
          <i class="none"></i>
        API Javadoc</a>
            </li>
              </ul>
        </li>
                                                                                                
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-down"></i>
        Project Reports</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="changes-report.html" title="Changelist">
          <i class="none"></i>
        Changelist</a>
            </li>
                    
      <li>
  
                          <a href="surefire-report.html" title="Test Results">
          <i class="none"></i>
        Test Results</a>
            </li>
                    
      <li>
  
                          <a href="failsafe-report.html" title="Integration Test Results">
          <i class="none"></i>
        Integration Test Results</a>
            </li>
              </ul>
        </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>java-hod-client</h1>
<p>Java Client for communicating with <a class="externalLink" href="http://www.idolondemand.com">HP Haven OnDemand</a></p>
<div class="section">
<h2><a name="About"></a>About</h2>
<p>java-hod-client provides a Java Interface to the HP Haven OnDemand APIs to simplify calling the HP Haven OnDemand APIs from Java, allowing consumers of java-hod-client to access HP Haven OnDemand in a typesafe way. It also automatically handles refreshed tokens in the headers of HP Haven OnDemand responses.</p></div>
<div class="section">
<h2><a name="Goals"></a>Goals</h2>
<p>Currently only a small subset of HP Haven OnDemand APIs are supported. The eventual aim to support all the HP Haven OnDemand APIs.</p>
<p>If an API you need is not supported, submit a pull request!</p></div>
<div class="section">
<h2><a name="Usage"></a>Usage</h2>
<p>java-hod-client is available from the central Maven repository.</p>

<div class="source">
<div class="source">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;com.hp.autonomy.hod&lt;/groupId&gt;
    &lt;artifactId&gt;java-hod-client&lt;/artifactId&gt;
    &lt;version&gt;0.10.0&lt;/version&gt;
&lt;/dependency&gt;
</pre></div></div>
<p>java-hod-client services are configured using instances of HodServiceConfig. The easiest way to do this is to use the default options:</p>

<div class="source">
<div class="source">
<pre>final HodServiceConfig config = new HodServiceConfig.Builder(&quot;https://api.idolondemand.com&quot;).build();
</pre></div></div>
<p>This will create a configuration object with an InMemoryTokenRepository for storing tokens, a default Jackson ObjectMapper, a default HodErrorHandler, and a default HTTP client. </p>
<p>It is also possible to override the default configuration:</p>

<div class="source">
<div class="source">
<pre>final HodServiceConfig config = new HodServiceConfig.Builder(&quot;https://api.idolondemand.com&quot;)
    .setTokenRepository(tokenRepository) // configure an alternative TokenRepository
    .setHttpClient(httpClient) // use a custom Apache HttpClient - useful if you're behind a proxy
    .setObjectMapper(objectMapper) // use a custom Jackson ObjectMapper if you're using custom types
    .setErrorHandler(errorHandler) // use a custom error handler
    .build():
</pre></div></div>
<p>Once a config object has been created, it can be used to construct services. To ensure the TokenRepository works correctly, the same configuration object should be used for all services.</p>

<div class="source">
<div class="source">
<pre>final AuthenticationService authenticationService = new AuthenticationServiceImp(config);

final QueryTextIndexService&lt;Documents&gt; queryTextIndexService = QueryTextIndexService.documentsService(config);
</pre></div></div>
<p>HP Haven OnDemand requires the use of a token to make API requests. These can be obtained with the AuthenticationService. The AuthenticationServiceImpl will store the token in the configured TokenRepository and return a TokenProxy which can be used to retrieve the token. This allows the token to be updated when the refresh_token header is sent by HP Haven OnDemand. For more information, consult the HP Haven OnDemand documentation.</p>

<div class="source">
<div class="source">
<pre>final TokenProxy tokenProxy = authenticationService.authenticateApplication(
    myApiKey,
    myApplication,
    myDomain,
    TokenType.simple
);
</pre></div></div>
<p>You can then call the methods on queryTextIndexService with the token proxy to communicate with HP Haven OnDemand.</p>

<div class="source">
<div class="source">
<pre>final QueryRequestBuilder params = new QueryRequestBuilder()
    .setAbsoluteMaxResults(10)
    .setTotalResults(true)
    .addIndexes(index);

final Documents documents = queryTextIndexService.queryTextIndexWithText(
    tokenProxy,
    &quot;cats&quot;,
    params);
</pre></div></div>
<p>If there is no token associated with the TokenProxy, or the token has expired according to its expiry field, a HodAuthenticationFailedException will be thrown.</p></div>
<div class="section">
<h2><a name="Library_structure"></a>Library structure</h2>
<p>APIs can be found in the com.hp.autonomy.hod.client.api package. APIs are packaged more or less according to their urls.</p></div>
<div class="section">
<h2><a name="Asynchronous_requests"></a>Asynchronous requests</h2>
<p>Some APIs are provided as a PollingService. These services will obtain a JobId from HP Haven OnDemand, and poll the job status API until completion.</p>

<div class="source">
<div class="source">
<pre>final AddToTextIndexService addToTextIndexService = new AddToTextIndexPollingService(config);
</pre></div></div>
<p>The methods on this service take a callback which will be called when the job is completed</p>

<div class="source">
<div class="source">
<pre>addToTextIndexService.addFileToTextIndex(
    tokenProxy, 
    file, 
    index, 
    params, 
    new HodJobCallback&lt;AddToTextIndexResponse&gt;() {
        @Override
        public void success(final AddToTextIndexResponse result) {
            // called if the job succeeds
        }

        @Override
        public void error(final HodErrorCode error) {
            // called if the job fails
        }

        @Override
        public void handleException(final RuntimeException exception) {
            // called if a RuntimeException is thrown during the process
        }
    });
</pre></div></div>
<p>The APIs which are currently asynchronous are</p>

<ul>
  
<li>AddToTextIndex</li>
  
<li>DeleteFromTextIndex</li>
  
<li>CreateTextIndex</li>
  
<li>DeleteTextIndex</li>
</ul></div>
<div class="section">
<h2><a name="TokenProxyService"></a>TokenProxyService</h2>
<p>For cases where you want to send the same token with every request, we provide TokenProxyService. When using a TokenProxyService, use the methods which do not take a TokenProxy as the first argument.</p>

<div class="source">
<div class="source">
<pre>// create a TokenProxyService
final TokenProxyService tokenProxyService = new TokenProxyService() {
    @Override
    public TokenProxy getTokenProxy() {
        return myTokenProxy;
    }
}

// create a configuration object
final HodServiceConfig config = new HodServiceConfig.Builder(&quot;https://api.idolondemand.com&quot;)
    .setTokenProxyService(tokenProxyService) // configure the TokenProxyService
    .build():

// query for documents using the token proxy provided by the service
final Documents documents = queryTextIndexService.queryTextIndexWithText(
    &quot;cats&quot;,
    params);
</pre></div></div>
<p>If a service method is called with a TokenProxy this will take priority over the TokenProxyService.</p></div>
<div class="section">
<h2><a name="HavenOnDemandService"></a>HavenOnDemandService</h2>
<p>For those times where the API you need to use is not currently supported, there is the HavenOnDemandService. This can query any API.</p>

<div class="source">
<div class="source">
<pre>final HavenOnDemandService havenOnDemandService = new HavenOnDemandServiceImpl(config);

final Map&lt;String, Object&gt; params = new HashMap&lt;&gt;();
params.put(&quot;text&quot;, &quot;*&quot;);

final Map&lt;String, Object&gt; result = havenOnDemandService.get(
    tokenProxy, 
    &quot;textindex&quot;, 
    &quot;query&quot;, 
    &quot;search&quot;, 
    1, 
    params, 
    Map.class
);
</pre></div></div>
<p>This approach requires a greater familiarity with the HP Haven OnDemand documentation. If Map is used as the return type, it also removes the type safety and gives an object which is only useful for things like automated transformation into JSON.</p>
<p>If you find yourself looking at the HavenOnDemandService, we encourage you to write a service for the API and submit a pull request.</p></div>
<div class="section">
<h2><a name="Contributing"></a>Contributing</h2>
<p>We welcome pull requests. These must be licensed under the MIT license. Please submit pull requests to the develop branch - the master branch is for stable code only.</p></div>
<div class="section">
<h2><a name="Is_it_any_good"></a>Is it any good?</h2>
<p>Yes.</p></div>
<div class="section">
<h2><a name="License"></a>License</h2>
<p>Copyright 2015 Hewlett-Packard Development Company, L.P.</p>
<p>Licensed under the MIT License (the &#x201c;License&#x201d;); you may not use this project except in compliance with the License.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                    2015
                        <a href="http://www.hp.com/">Hewlett-Packard Development Company, L.P.</a>.
            All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
